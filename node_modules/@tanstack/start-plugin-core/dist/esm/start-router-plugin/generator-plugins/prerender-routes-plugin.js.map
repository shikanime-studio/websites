{"version":3,"file":"prerender-routes-plugin.js","sources":["../../../../src/start-router-plugin/generator-plugins/prerender-routes-plugin.ts"],"sourcesContent":["import { inferFullPath } from '@tanstack/router-generator'\nimport type { GeneratorPlugin, RouteNode } from '@tanstack/router-generator'\n\n/**\n * this plugin gets the prerenderable paths and stores it on globalThis\n * so that it can be accessed later (e.g. from a vite plugin)\n */\nexport function prerenderRoutesPlugin(): GeneratorPlugin {\n  return {\n    name: 'prerender-routes-plugin',\n    onRouteTreeChanged: ({ routeNodes }) => {\n      globalThis.TSS_PRERENDABLE_PATHS = getPrerenderablePaths(routeNodes)\n    },\n  }\n}\n\nfunction getPrerenderablePaths(\n  routeNodes: Array<RouteNode>,\n): Array<{ path: string }> {\n  const paths = new Set<string>(['/'])\n\n  for (const route of routeNodes) {\n    if (!route.routePath) continue\n    // filter routes that are layout\n    if (route.isNonPath === true) continue\n\n    // filter dynamic routes\n    // if routePath contains $ it is dynamic\n    if (route.routePath.includes('$')) continue\n\n    // filter routes that do not have a component, i.e api routes\n    if (!route.createFileRouteProps?.has('component')) continue\n\n    paths.add(inferFullPath(route))\n  }\n\n  return Array.from(paths).map((path) => ({ path }))\n}\n"],"names":[],"mappings":";AAOO,SAAS,wBAAyC;AACvD,SAAO;AAAA,IACL,MAAM;AAAA,IACN,oBAAoB,CAAC,EAAE,iBAAiB;AACtC,iBAAW,wBAAwB,sBAAsB,UAAU;AAAA,IACrE;AAAA,EAAA;AAEJ;AAEA,SAAS,sBACP,YACyB;AACzB,QAAM,QAAQ,oBAAI,IAAY,CAAC,GAAG,CAAC;AAEnC,aAAW,SAAS,YAAY;AAC9B,QAAI,CAAC,MAAM,UAAW;AAEtB,QAAI,MAAM,cAAc,KAAM;AAI9B,QAAI,MAAM,UAAU,SAAS,GAAG,EAAG;AAGnC,QAAI,CAAC,MAAM,sBAAsB,IAAI,WAAW,EAAG;AAEnD,UAAM,IAAI,cAAc,KAAK,CAAC;AAAA,EAChC;AAEA,SAAO,MAAM,KAAK,KAAK,EAAE,IAAI,CAAC,UAAU,EAAE,KAAA,EAAO;AACnD;"}