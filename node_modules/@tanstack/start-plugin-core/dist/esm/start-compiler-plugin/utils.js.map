{"version":3,"file":"utils.js","sources":["../../../src/start-compiler-plugin/utils.ts"],"sourcesContent":["import { codeFrameColumns } from '@babel/code-frame'\nimport * as t from '@babel/types'\nimport type babel from '@babel/core'\n\nexport function codeFrameError(\n  code: string,\n  loc: {\n    start: { line: number; column: number }\n    end: { line: number; column: number }\n  },\n  message: string,\n) {\n  const frame = codeFrameColumns(\n    code,\n    {\n      start: loc.start,\n      end: loc.end,\n    },\n    {\n      highlightCode: true,\n      message,\n    },\n  )\n\n  return new Error(frame)\n}\n\nexport function cleanId(id: string): string {\n  // Remove null byte prefix used by Vite/Rollup for virtual modules\n  if (id.startsWith('\\0')) {\n    id = id.slice(1)\n  }\n  const queryIndex = id.indexOf('?')\n  return queryIndex === -1 ? id : id.substring(0, queryIndex)\n}\n\n/**\n * Strips a method call by replacing it with its callee object.\n * E.g., `foo().bar()` -> `foo()`\n *\n * This is a common pattern used when removing method calls from chains\n * (e.g., removing .server() from middleware on client, or .inputValidator() on client).\n *\n * @param callPath - The path to the CallExpression to strip\n */\nexport function stripMethodCall(\n  callPath: babel.NodePath<t.CallExpression>,\n): void {\n  if (t.isMemberExpression(callPath.node.callee)) {\n    callPath.replaceWith(callPath.node.callee.object)\n  }\n}\n"],"names":[],"mappings":";;AAIO,SAAS,eACd,MACA,KAIA,SACA;AACA,QAAM,QAAQ;AAAA,IACZ;AAAA,IACA;AAAA,MACE,OAAO,IAAI;AAAA,MACX,KAAK,IAAI;AAAA,IAAA;AAAA,IAEX;AAAA,MACE,eAAe;AAAA,MACf;AAAA,IAAA;AAAA,EACF;AAGF,SAAO,IAAI,MAAM,KAAK;AACxB;AAEO,SAAS,QAAQ,IAAoB;AAE1C,MAAI,GAAG,WAAW,IAAI,GAAG;AACvB,SAAK,GAAG,MAAM,CAAC;AAAA,EACjB;AACA,QAAM,aAAa,GAAG,QAAQ,GAAG;AACjC,SAAO,eAAe,KAAK,KAAK,GAAG,UAAU,GAAG,UAAU;AAC5D;AAWO,SAAS,gBACd,UACM;AACN,MAAI,EAAE,mBAAmB,SAAS,KAAK,MAAM,GAAG;AAC9C,aAAS,YAAY,SAAS,KAAK,OAAO,MAAM;AAAA,EAClD;AACF;"}