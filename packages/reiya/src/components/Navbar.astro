---
import { Image } from "astro:assets";
import { validateSession } from "../lib/session";
import UserMenuMenu from "./NavbarUserMenu.astro";
import logoImage from "../assets/logo.png";

let session;
try {
  session = await validateSession(Astro.cookies);
} catch (e) {
  session = null;
}
---

<nav
  class="z-20 mx-auto flex w-full justify-between md:w-4/5 lg:w-4/5 xl:w-3/5"
>
  <div class="navbar">
    <div class="navbar-start">
      <a href="/" class="ml-2 flex md:mr-24">
        <Image
          src={logoImage}
          class="mr-3"
          alt="Reiya Logo"
          width="40"
          height="40"
          loading="eager"
        />
        <span
          class="self-center whitespace-nowrap text-xl font-semibold sm:text-2xl"
        >
          Reiya
        </span>
      </a>
    </div>
    <div class="navbar-center"></div>
    <div class="navbar-end">
      <div class="ml-3 flex items-center">
        {
          session ? (
            <UserMenu accountId={session.accountId} />
          ) : (
            <a class="btn btn-primary rounded-full" href="/flows/google">
              Sign up free
            </a>
          )
        }
      </div>
    </div>
  </div>
</nav>
