---
import Logo from "../assets/logo.png";
import LoginButton from "./LoginButton";
import LogoutButton from "./LogoutButton";
import { Image } from "@unpic/react";
import { BsFillPersonVcardFill, BsThreeDotsVertical } from "react-icons/bs";
import { FaMagnifyingGlass } from "react-icons/fa6";

interface Props {
  session?: {
    user: {
      name: string;
      image?: string | null;
    };
  } | null;
}

const { session } = Astro.props;
---

<nav
  class="navbar bg-base-100 fixed top-0 z-50 w-full justify-between px-4 lg:px-6"
>
  <!-- Navbar Start -->
  <div class="flex items-center">
    <div class="flex items-center gap-6">
      <a
        href="/"
        class="text-base-content flex items-center gap-2 text-xl font-bold tracking-tight transition-opacity hover:opacity-80"
      >
        <img
          src={Logo.src}
          class="h-8 w-auto"
          alt="Reiya Logo"
          width="32"
          height="32"
        />
        Reiya
      </a>

      <div class="hidden items-center gap-1 md:flex">
        {
          session && (
            <a
              href="/following"
              class="btn btn-ghost text-base-content/70 hover:text-base-content hover:bg-base-200 rounded-full font-medium"
            >
              Following
            </a>
          )
        }
        <a
          href="/explore"
          class="btn btn-ghost text-base-content/70 hover:text-base-content hover:bg-base-200 rounded-full font-medium"
        >
          Explore
        </a>

        <div class="dropdown dropdown-bottom">
          <button
            type="button"
            class="btn btn-ghost btn-circle btn-sm text-base-content/70 hover:text-base-content hover:bg-base-200"
          >
            <BsThreeDotsVertical />
          </button>
          <ul
            class="dropdown-content menu bg-base-100 rounded-box z-1 w-52 p-2 shadow"
          >
            <li>
              <a href="/privacy-notices">Privacy Notices</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- Navbar Center -->
  <div class="hidden max-w-2xl flex-1 justify-center px-4 lg:flex">
    <div class="relative w-full">
      <input
        type="text"
        placeholder="Search for a character, license, artist, or convention"
        class="input input-sm bg-base-200 focus:ring-primary/20 h-10 w-full rounded-full border-none pr-4 pl-10 transition-all focus:ring-2 focus:outline-none"
      />
      <div
        class="text-base-content/50 absolute top-1/2 left-3.5 -translate-y-1/2"
      >
        <FaMagnifyingGlass className="h-3.5 w-3.5" />
      </div>
    </div>
  </div>

  <!-- Navbar End -->
  <div class="flex items-center justify-end gap-2">
    <!-- Icons -->
    {
      session && (
        <>
          <button class="btn btn-ghost btn-circle btn-sm text-base-content/80">
            <span class="sr-only">Messages</span>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="h-5 w-5"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 0 1 .865-.501 48.172 48.172 0 0 0 3.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z"
              />
            </svg>
          </button>

          <button class="btn btn-ghost btn-circle btn-sm indicator text-base-content/80">
            <span class="sr-only">Notifications</span>
            <span class="indicator-item badge badge-primary badge-xs border-base-100 top-2 right-2 h-2 w-2 rounded-full border-2 p-0" />
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="h-5 w-5"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"
              />
            </svg>
          </button>
        </>
      )
    }

    <!-- CTA Button -->
    <button
      type="button"
      class="btn btn-primary hidden rounded-full px-4 font-bold normal-case shadow-sm transition-all hover:shadow-md sm:flex"
    >
      + Share
    </button>

    <!-- User Menu / Login -->
    <div class="flex items-center pl-1">
      {
        session ? (
          <div class="dropdown dropdown-end">
            <button type="button" class="avatar btn btn-circle btn-ghost">
              <div class="w-10 rounded-full">
                <Image
                  src={
                    session.user.image ||
                    `https://ui-avatars.com/api/?name=${session.user.name}`
                  }
                  alt={`${session.user.name} Avatar`}
                  width={40}
                  height={40}
                  layout="constrained"
                  className="h-full w-full object-cover"
                />
              </div>
            </button>
            <ul class="menu dropdown-content rounded-box bg-base-100 z-1 w-52 p-2 shadow">
              <li>
                <a href="/user">
                  <BsFillPersonVcardFill />
                  User
                </a>
              </li>
              <div class="divider my-0" />
              <li>
                <LogoutButton client:load />
              </li>
            </ul>
          </div>
        ) : (
          <LoginButton client:load />
        )
      }
    </div>
  </div>
</nav>
